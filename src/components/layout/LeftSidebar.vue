<template>
  <!-- ì¢Œì¸¡ íŒ¨ë„ -->
  <aside 
    class="w-[15%] min-h-screen bg-gradient-to-b from-slate-50 to-white border-r border-gray-200 z-40 overflow-y-auto transition-all duration-300 ease-in-out"
    :class="{
      'md:block': true,
      'hidden md:block': !isSidebarOpen,
      'block md:block': isSidebarOpen,
      'w-80 md:w-[15%]': true
    }"
  >
    <!-- ëª¨ë°”ì¼ ë‹«ê¸° ë²„íŠ¼ -->
    <div class="flex justify-between items-center p-4 md:hidden border-b border-gray-100 bg-white sticky top-0 z-50">
      <h2 class="font-bold text-gray-800 text-lg">ë„êµ¬ ë©”ë‰´</h2>
      <button 
        @click="closeSidebar"
        class="p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200"
        aria-label="ë©”ë‰´ ë‹«ê¸°"
      >
        <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- íŒ¨ë„ í—¤ë” (ë°ìŠ¤í¬í†±) -->
    <div class="hidden md:block p-6 border-b border-gray-100 bg-white sticky top-0 z-50">
      <h2 class="font-bold text-gray-800 text-lg mb-1">ë„êµ¬ ë©”ë‰´</h2>
      <p class="text-sm text-gray-500">ì›í•˜ëŠ” ë„êµ¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
    </div>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ -->
    <nav class="p-4 space-y-8">
      <!-- ë¯¸ë””ì–´ ë„êµ¬ -->
      <div class="space-y-3">
        <div class="flex items-center space-x-2 px-3 py-2 bg-blue-50 rounded-lg border border-blue-100">
          <span class="text-xl">ğŸ› </span>
          <h3 class="text-sm font-bold text-blue-800 uppercase tracking-wider">ë¯¸ë””ì–´ ë„êµ¬</h3>
        </div>
        <div class="space-y-1 pl-2">
          <RouterLink 
            to="/image/qr-generator"
            @click="handleMenuClick"
            class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-blue-700 hover:bg-blue-50 transition-all duration-200 group border border-transparent hover:border-blue-200"
            :class="{ 'text-blue-700 bg-blue-100 border-blue-300 font-medium shadow-sm': $route.name === 'qr-generator' }"
          >
            <span class="text-lg group-hover:scale-110 transition-transform duration-200">ğŸ”—</span>
            <span class="text-sm font-medium">QR ì½”ë“œ ìƒì„±ê¸°</span>
          </RouterLink>
          <RouterLink 
            to="/youtube/thumbnail"
            @click="handleMenuClick"
            class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-blue-700 hover:bg-blue-50 transition-all duration-200 group border border-transparent hover:border-blue-200"
            :class="{ 'text-blue-700 bg-blue-100 border-blue-300 font-medium shadow-sm': $route.name === 'youtube-thumbnail' }"
          >
            <span class="text-lg group-hover:scale-110 transition-transform duration-200">ğŸ“¹</span>
            <span class="text-sm font-medium">ìœ íŠœë¸Œ ì¸ë„¤ì¼ ì¶”ì¶œê¸°</span>
          </RouterLink>
        </div>
      </div>
      
      <!-- ë‚ ì§œ/ì‹œê°„ ë„êµ¬ -->
      <div class="space-y-3">
        <div class="flex items-center space-x-2 px-3 py-2 bg-green-50 rounded-lg border border-green-100">
          <span class="text-xl">ğŸ“…</span>
          <h3 class="text-sm font-bold text-green-800 uppercase tracking-wider">ë‚ ì§œ/ì‹œê°„ ë„êµ¬</h3>
        </div>
        <div class="space-y-1 pl-2">
          <RouterLink 
            to="/date/calculator"
            @click="handleMenuClick"
            class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-green-700 hover:bg-green-50 transition-all duration-200 group border border-transparent hover:border-green-200"
            :class="{ 'text-green-700 bg-green-100 border-green-300 font-medium shadow-sm': $route.name === 'date-calculator' }"
          >
            <span class="text-lg group-hover:scale-110 transition-transform duration-200">ğŸ•’</span>
            <span class="text-sm font-medium">ë‚ ì§œ ê³„ì‚°ê¸°</span>
          </RouterLink>
          <RouterLink 
            to="/date/dday"
            @click="handleMenuClick"
            class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-green-700 hover:bg-green-50 transition-all duration-200 group border border-transparent hover:border-green-200"
            :class="{ 'text-green-700 bg-green-100 border-green-300 font-medium shadow-sm': $route.name === 'dday-calculator' }"
          >
            <span class="text-lg group-hover:scale-110 transition-transform duration-200">â°</span>
            <span class="text-sm font-medium">D-Day ê³„ì‚°ê¸°</span>
          </RouterLink>
          <RouterLink 
            to="/date/weekday"
            @click="handleMenuClick"
            class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-green-700 hover:bg-green-50 transition-all duration-200 group border border-transparent hover:border-green-200"
            :class="{ 'text-green-700 bg-green-100 border-green-300 font-medium shadow-sm': $route.name === 'weekday-calculator' }"
          >
            <span class="text-lg group-hover:scale-110 transition-transform duration-200">ğŸ“…</span>
            <span class="text-sm font-medium">ìš”ì¼ ê³„ì‚°ê¸°</span>
          </RouterLink>
          <RouterLink 
            to="/date/age"
            @click="handleMenuClick"
            class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-green-700 hover:bg-green-50 transition-all duration-200 group border border-transparent hover:border-green-200"
            :class="{ 'text-green-700 bg-green-100 border-green-300 font-medium shadow-sm': $route.name === 'age-calculator' }"
          >
            <span class="text-lg group-hover:scale-110 transition-transform duration-200">ğŸ‚</span>
            <span class="text-sm font-medium">ë§Œ ë‚˜ì´ ê³„ì‚°ê¸°</span>
          </RouterLink>
        </div>
      </div>
      
      <!-- í…ìŠ¤íŠ¸ ë„êµ¬ -->
      <div class="space-y-3">
        <div class="flex items-center space-x-2 px-3 py-2 bg-purple-50 rounded-lg border border-purple-100">
          <span class="text-xl">ğŸ“</span>
          <h3 class="text-sm font-bold text-purple-800 uppercase tracking-wider">í…ìŠ¤íŠ¸ ë„êµ¬</h3>
        </div>
        <div class="space-y-1 pl-2">
          <RouterLink 
            to="/text/case-converter"
            @click="handleMenuClick"
            class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-purple-700 hover:bg-purple-50 transition-all duration-200 group border border-transparent hover:border-purple-200"
            :class="{ 'text-purple-700 bg-purple-100 border-purple-300 font-medium shadow-sm': $route.name === 'case-converter' }"
          >
            <span class="text-lg group-hover:scale-110 transition-transform duration-200">ğŸ“„</span>
            <span class="text-sm font-medium">ëŒ€ì†Œë¬¸ì ë³€í™˜ê¸°</span>
          </RouterLink>
          <RouterLink 
            to="/text/word-counter"
            @click="handleMenuClick"
            class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-700 hover:text-purple-700 hover:bg-purple-50 transition-all duration-200 group border border-transparent hover:border-purple-200"
            :class="{ 'text-purple-700 bg-purple-100 border-purple-300 font-medium shadow-sm': $route.name === 'word-counter' }"
          >
            <span class="text-lg group-hover:scale-110 transition-transform duration-200">ğŸ“Š</span>
            <span class="text-sm font-medium">ë‹¨ì–´/ë¬¸ì ìˆ˜ ì„¸ê¸°</span>
          </RouterLink>
        </div>
      </div>
    </nav>

    <!-- íŒ¨ë„ í•˜ë‹¨ ì •ë³´ -->
    <div class="p-4 mt-auto border-t border-gray-100 bg-gray-50">
      <p class="text-xs text-gray-500 text-center">
        ğŸ’¡ í•„ìš”í•œ ë„êµ¬ë¥¼ ë¹ ë¥´ê²Œ ì°¾ì•„ë³´ì„¸ìš”
      </p>
    </div>
  </aside>

  <!-- ëª¨ë°”ì¼ ì˜¤ë²„ë ˆì´ -->
  <div 
    v-if="isSidebarOpen" 
    @click="closeSidebar"
    class="fixed inset-0 bg-black bg-opacity-50 z-30 md:hidden backdrop-blur-sm"
  ></div>
</template>

<script setup lang="ts">
import { watch } from 'vue'
import { RouterLink, useRoute } from 'vue-router'
import { useSidebar } from '@/composables/useSidebar'

const route = useRoute()
const { isSidebarOpen, closeSidebar } = useSidebar()

// ë©”ë‰´ í´ë¦­ ì‹œ ëª¨ë°”ì¼ì—ì„œ ì‚¬ì´ë“œë°” ë‹«ê¸°
const handleMenuClick = () => {
  if (window.innerWidth < 768) {
    closeSidebar()
  }
}

// ë¼ìš°íŠ¸ ë³€ê²½ ì‹œ ì‚¬ì´ë“œë°” ë‹«ê¸° (ëª¨ë°”ì¼ì—ì„œ)
watch(() => route.path, () => {
  if (window.innerWidth < 768) {
    closeSidebar()
  }
})
</script>

<style scoped>
/* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
aside::-webkit-scrollbar {
  width: 6px;
}

aside::-webkit-scrollbar-track {
  background: transparent;
}

aside::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 3px;
}

aside::-webkit-scrollbar-thumb:hover {
  background: #94a3b8;
}

/* ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ */
.group:hover .group-hover\:scale-110 {
  transform: scale(1.1);
}

/* í¬ì»¤ìŠ¤ ìƒíƒœ ê°œì„  */
.focus\:ring-2:focus {
  outline: none;
  ring-width: 2px;
  ring-color: rgb(59 130 246 / 0.5);
}
</style> 